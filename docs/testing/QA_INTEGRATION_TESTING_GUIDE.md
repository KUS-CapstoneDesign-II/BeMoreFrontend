# 🧪 BeMore AI 음성 채팅 통합 테스트 가이드

**작성일**: 2025-01-14
**버전**: v1.0
**대상**: QA 팀, 개발자, PM
**목적**: User Flow, Data Flow, UX, UI 전체 점검

---

## 📋 목차

1. [User Flow 점검](#1-user-flow-점검)
2. [Data Flow 점검](#2-data-flow-점검)
3. [UX 점검](#3-ux-점검)
4. [UI 점검](#4-ui-점검)
5. [통합 테스트 시나리오](#5-통합-테스트-시나리오)
6. [에러 시나리오](#6-에러-시나리오)
7. [성능 점검](#7-성능-점검)
8. [접근성 점검](#8-접근성-점검)
9. [테스트 자동화](#9-테스트-자동화)
10. [버그 리포트 템플릿](#10-버그-리포트-템플릿)

---

## 1. User Flow 점검

### 전체 사용자 여정

```
① 세션 시작
   ↓
② 카메라/마이크 권한 요청
   ↓
③ WebSocket 연결
   ↓
④ 얼굴 감정 분석 시작
   ↓
⑤ 음성 입력 (사용자 말하기)
   ↓
⑥ STT 변환 (음성 → 텍스트)
   ↓
⑦ [Auto-trigger] AI 응답 요청
   ↓
⑧ AI 스트리밍 응답 수신
   ↓
⑨ Video Overlay 표시
   ↓
⑩ TTS 음성 재생
   ↓
⑪ Overlay 자동 숨김
   ↓
⑫ 다음 대화 대기
   ↓
⑬ 세션 종료
```

### 1.1 세션 시작 플로우

#### 테스트 케이스 1-1: 정상 세션 시작
- [ ] **예상 동작**: "세션 시작" 버튼 클릭 → 로딩 → 카메라 화면 표시
- [ ] **확인 방법**:
  - 버튼 클릭 후 1-2초 이내 카메라 활성화
  - 비디오 피드가 화면에 표시됨
  - Session ID가 생성됨 (개발자 도구 확인)
- [ ] **성공 기준**:
  - 카메라 화면 정상 표시
  - WebSocket 연결 성공 (Network 탭에서 WS 연결 확인)
  - Console에 에러 없음
- [ ] **실패 시**:
  - 에러 메시지 표시 확인
  - "카메라 접근 권한이 필요합니다" 안내

**소요 시간**: 1분
**우선순위**: P0 (치명적)
**담당**: QA + Dev

---

#### 테스트 케이스 1-2: 카메라 권한 거부
- [ ] **예상 동작**: 권한 거부 → 에러 메시지 표시
- [ ] **확인 방법**:
  - 브라우저 설정에서 카메라 권한 차단
  - 세션 시작 시도
- [ ] **성공 기준**:
  - 사용자 친화적 에러 메시지
  - 재시도 방법 안내
- [ ] **실패 시**:
  - 기술적 에러 노출되면 안 됨
  - "NotAllowedError" 같은 메시지 노출 금지

**소요 시간**: 2분
**우선순위**: P1 (중요)

---

### 1.2 감정 분석 플로우

#### 테스트 케이스 1-3: 감정 감지 정확성
- [ ] **예상 동작**: 표정 변화 → 감정 상태 업데이트
- [ ] **확인 방법**:
  - 웃는 표정 → "행복" 표시
  - 찡그린 표정 → "분노" 또는 "슬픔" 표시
  - 무표정 → "중립" 표시
- [ ] **성공 기준**:
  - 2초 이내 감정 상태 업데이트
  - UI에 감정 배지 표시
- [ ] **실패 시**:
  - 감정이 업데이트되지 않음
  - 잘못된 감정 표시

**소요 시간**: 3분
**우선순위**: P1
**담당**: QA

---

### 1.3 음성 입력 → AI 응답 플로우

#### 테스트 케이스 1-4: 정상 대화 플로우
- [ ] **예상 동작**:
  1. 사용자가 "안녕하세요" 말함
  2. STT가 텍스트로 변환
  3. Video Overlay에 사용자 메시지 표시 (파란색 배경)
  4. 감정 배지 표시 (예: "중립")
  5. 3초 후 사용자 메시지 자동 사라짐
  6. AI 응답 스트리밍 시작
  7. Overlay에 "응답 생성 중..." 표시
  8. 청크 단위로 메시지 누적 표시
  9. TTS 재생 시작 → "🔊 재생 중" 표시
  10. TTS 종료 1초 후 Overlay 사라짐

- [ ] **확인 방법**:
  - 브라우저 콘솔에서 로그 확인:
    ```
    [STT] Result: 안녕하세요
    [AI Stream] Begin
    [AI Stream] Chunk: 안녕하세요.
    [AI Stream] Chunk: 무엇을 도와드릴까요?
    [AI Stream] Complete
    [TTS] Speaking: 안녕하세요. 무엇을 도와드릴까요?
    ```

- [ ] **성공 기준**:
  - 첫 AI 응답 < 2초
  - 전체 응답 < 10초
  - Overlay 애니메이션 부드러움
  - TTS 음성 명확함

- [ ] **실패 시**:
  - 응답 없음
  - Overlay 표시 안 됨
  - TTS 재생 안 됨
  - 에러 메시지 확인

**소요 시간**: 5분
**우선순위**: P0
**담당**: QA + Dev

---

#### 테스트 케이스 1-5: 감정별 AI 응답 차이
- [ ] **예상 동작**: 감정에 따라 AI 응답 톤 변화

**테스트 서브케이스**:
- [ ] **행복 (Happy)**:
  - 표정: 웃는 얼굴
  - 입력: "오늘 기분이 좋아요"
  - 예상 응답 톤: 긍정 강화, 행복 유지 방법 제시

- [ ] **슬픔 (Sad)**:
  - 표정: 찡그린 얼굴, 입꼬리 내림
  - 입력: "요즘 우울해요"
  - 예상 응답 톤: 공감, 위로, 긍정적 측면 찾기

- [ ] **불안 (Anxious)**:
  - 표정: 긴장한 표정
  - 입력: "걱정이 많아요"
  - 예상 응답 톤: 안정감 제공, 구체적 대처 방법

- [ ] **분노 (Angry)**:
  - 표정: 눈썹 치켜올림
  - 입력: "화가 나요"
  - 예상 응답 톤: 감정 수용, 진정, 건설적 표현 방법

- [ ] **성공 기준**:
  - 각 감정별로 적절한 응답 톤
  - 감정 배지가 Overlay에 표시됨

**소요 시간**: 15분 (8가지 감정 × 2분)
**우선순위**: P1
**담당**: QA + PM

---

### 1.4 세션 종료 플로우

#### 테스트 케이스 1-6: 정상 세션 종료
- [ ] **예상 동작**:
  1. "세션 종료" 버튼 클릭
  2. 확인 다이얼로그 표시
  3. "예" 클릭 → 세션 종료
  4. WebSocket 연결 해제
  5. 카메라/마이크 권한 해제
  6. 세션 요약 표시 (선택)

- [ ] **확인 방법**:
  - Network 탭에서 WS 연결 해제 확인
  - 카메라 LED 꺼짐

- [ ] **성공 기준**:
  - 깔끔한 리소스 정리
  - 메모리 누수 없음

**소요 시간**: 2분
**우선순위**: P0

---

## 2. Data Flow 점검

### 전체 데이터 흐름

```
Frontend State (React)
   ↓
WebSocket Send
   ↓
Backend Handler (Node.js)
   ↓
Gemini API Request
   ↓
AI Response Stream
   ↓
Backend → Frontend (WebSocket)
   ↓
Frontend State Update
   ↓
UI Render (Overlay)
```

### 2.1 Frontend → Backend 메시지

#### 테스트 케이스 2-1: AI 응답 요청 메시지 검증

- [ ] **확인 방법**:
  - 브라우저 개발자 도구 → Network → WS
  - "request_ai_response" 메시지 클릭

- [ ] **예상 메시지 형식**:
  ```json
  {
    "type": "request_ai_response",
    "data": {
      "message": "요즘 스트레스를 많이 받아요",
      "emotion": "anxious",
      "timestamp": 1704902400000
    }
  }
  ```

- [ ] **필수 필드 검증**:
  - [ ] `type` = "request_ai_response"
  - [ ] `data.message` = 문자열 (1-2000자)
  - [ ] `data.emotion` = 8가지 중 하나 또는 null
  - [ ] `data.timestamp` = 숫자 (milliseconds)

- [ ] **성공 기준**:
  - 모든 필드 존재
  - 데이터 타입 일치
  - Backend가 정상 수신

**소요 시간**: 3분
**우선순위**: P0
**자동화**: 가능 (E2E)

---

### 2.2 Backend → Frontend 응답 메시지

#### 테스트 케이스 2-2: 스트리밍 응답 검증

- [ ] **Stage 1: ai_stream_begin**
  ```json
  {
    "type": "ai_stream_begin",
    "data": {}
  }
  ```
  - [ ] 수신 즉시 Overlay "응답 생성 중..." 표시

- [ ] **Stage 2: ai_stream_chunk (여러 번)**
  ```json
  {
    "type": "ai_stream_chunk",
    "data": {
      "chunk": "스트레스를 받고 계시는군요. "
    }
  }
  ```
  - [ ] ⚠️ **CRITICAL**: 필드명이 `chunk`인지 확인 (`text` 아님!)
  - [ ] 청크가 누적되어 표시되는지 확인
  - [ ] 타이핑 효과 (커서 깜빡임) 확인

- [ ] **Stage 3: ai_stream_complete**
  ```json
  {
    "type": "ai_stream_complete",
    "data": {}
  }
  ```
  - [ ] 스트리밍 종료
  - [ ] TTS 재생 시작
  - [ ] "🔊 재생 중" 표시

- [ ] **성공 기준**:
  - 3단계 순서 정확
  - 메시지 누적 정상
  - UI 업데이트 부드러움

**소요 시간**: 5분
**우선순위**: P0
**자동화**: 가능

---

#### 테스트 케이스 2-3: 에러 응답 검증

- [ ] **에러 메시지 형식**:
  ```json
  {
    "type": "ai_stream_error",
    "data": {
      "error": "세션이 만료되었습니다"
    }
  }
  ```

- [ ] **Frontend 에러 처리 확인**:
  - [ ] Overlay에 빨간색 배경 표시
  - [ ] 라벨: "오류"
  - [ ] 메시지: 사용자 친화적 (기술 용어 없음)
  - [ ] 안내: "💡 세션이 만료되었을 수 있습니다. 페이지를 새로고침해주세요."
  - [ ] 5초 후 자동 사라짐

- [ ] **특수 에러 패턴 - Foreign Key**:
  - Backend 에러에 "foreign key", "conversations", "session_id" 포함 시
  - Frontend가 자동으로 "세션이 만료되었습니다"로 변환
  - 확인: Backend에서 FK 에러 발생시켜 테스트

**소요 시간**: 5분
**우선순위**: P1

---

## 3. UX 점검

### 3.1 응답 시간

#### 테스트 케이스 3-1: 첫 AI 응답 시간 (TTFR - Time To First Response)

- [ ] **측정 방법**:
  - 사용자 음성 입력 종료 시점
  - 첫 `ai_stream_chunk` 수신 시점
  - 차이 계산

- [ ] **성공 기준**:
  - P50 (중간값): < 1.5초
  - P95 (95%): < 2.5초
  - P99 (99%): < 5초

- [ ] **측정 도구**:
  ```javascript
  // 브라우저 콘솔에서
  performance.mark('ai-request-start');
  // ... AI 요청
  performance.mark('ai-response-start');
  performance.measure('TTFR', 'ai-request-start', 'ai-response-start');
  console.log(performance.getEntriesByName('TTFR')[0].duration);
  ```

**소요 시간**: 10분 (10회 측정)
**우선순위**: P0
**담당**: QA + Dev

---

#### 테스트 케이스 3-2: 전체 응답 완료 시간 (TTLR - Time To Last Response)

- [ ] **측정 방법**:
  - 사용자 음성 입력 종료 시점
  - `ai_stream_complete` 수신 시점
  - 차이 계산

- [ ] **성공 기준**:
  - 평균: < 8초
  - 최대: < 15초

**소요 시간**: 10분
**우선순위**: P1

---

### 3.2 로딩 인디케이터

#### 테스트 케이스 3-3: 로딩 상태 표시

- [ ] **확인 사항**:
  - [ ] `ai_stream_begin` 수신 즉시 "응답 생성 중..." 표시
  - [ ] 커서 깜빡임 애니메이션
  - [ ] 로딩 중 입력 폼 비활성화 (선택)

- [ ] **성공 기준**:
  - 즉각적 피드백 (< 100ms)
  - 애니메이션 부드러움

**소요 시간**: 2분
**우선순위**: P1

---

### 3.3 에러 메시지 명확성

#### 테스트 케이스 3-4: 사용자 친화적 에러 메시지

- [ ] **확인 사항**:
  - [ ] 빈 메시지 전송 → "메시지를 입력해주세요"
  - [ ] 2000자 초과 → "메시지가 너무 깁니다 (최대 2000자)"
  - [ ] 세션 만료 → "세션이 만료되었습니다"
  - [ ] 네트워크 에러 → "AI 서비스가 일시적으로 사용할 수 없습니다"

- [ ] **금지 사항**:
  - [ ] ❌ "foreign key constraint violation"
  - [ ] ❌ "NoneType object has no attribute 'get'"
  - [ ] ❌ "Connection timeout"
  - [ ] ❌ "500 Internal Server Error"

**소요 시간**: 5분
**우선순위**: P0

---

### 3.4 핸즈프리 대화 경험

#### 테스트 케이스 3-5: Auto-trigger 기능

- [ ] **예상 동작**:
  1. 사용자가 음성으로 말함
  2. STT 변환 완료
  3. **자동으로** AI 응답 요청 (버튼 클릭 불필요)
  4. AI 응답 수신 및 표시

- [ ] **확인 방법**:
  - 연속으로 3-5회 대화
  - 매번 버튼 클릭 없이 대화 진행되는지 확인

- [ ] **성공 기준**:
  - 핸즈프리 대화 가능
  - 자연스러운 대화 흐름

**소요 시간**: 5분
**우선순위**: P0

---

## 4. UI 점검

### 4.1 Video Overlay

#### 테스트 케이스 4-1: Overlay 위치 및 크기

- [ ] **확인 사항**:
  - [ ] 비디오 피드 위에 표시됨
  - [ ] 가독성 확보 (반투명 배경)
  - [ ] 비디오를 가리지 않음 (적절한 크기)
  - [ ] 중앙 하단 또는 상단 배치

- [ ] **테스트 해상도**:
  - [ ] 1920×1080 (Full HD)
  - [ ] 1366×768 (일반 노트북)
  - [ ] 390×844 (iPhone 12)
  - [ ] 360×640 (Android)

**소요 시간**: 5분
**우선순위**: P1

---

#### 테스트 케이스 4-2: Overlay 애니메이션

- [ ] **확인 사항**:
  - [ ] 페이드 인 (0.3초)
  - [ ] 타이핑 효과 (커서 깜빡임)
  - [ ] 페이드 아웃 (0.3초)
  - [ ] 60fps 부드러움

- [ ] **확인 방법**:
  - 브라우저 개발자 도구 → Performance 탭
  - "Record" → 대화 진행 → "Stop"
  - FPS 그래프 확인 (60fps 유지)

**소요 시간**: 3분
**우선순위**: P2

---

### 4.2 감정 배지

#### 테스트 케이스 4-3: 감정 배지 표시

- [ ] **확인 사항**:
  - [ ] 사용자 메시지에만 감정 배지 표시
  - [ ] AI 메시지에는 표시 안 됨
  - [ ] 8가지 감정별 한글 레이블:
    - [ ] happy → "행복"
    - [ ] sad → "슬픔"
    - [ ] angry → "분노"
    - [ ] anxious → "불안"
    - [ ] neutral → "중립"
    - [ ] surprised → "놀람"
    - [ ] disgusted → "혐오"
    - [ ] fearful → "두려움"

**소요 시간**: 3분
**우선순위**: P1

---

### 4.3 에러 UI

#### 테스트 케이스 4-4: 에러 Overlay 스타일

- [ ] **확인 사항**:
  - [ ] 배경색: 빨간색 (`bg-red-600/90`)
  - [ ] 라벨: "오류"
  - [ ] 메시지: 사용자 친화적 텍스트
  - [ ] 안내: "💡 세션이 만료되었을 수 있습니다. 페이지를 새로고침해주세요."
  - [ ] 5초 후 자동 사라짐

**소요 시간**: 2분
**우선순위**: P1

---

### 4.4 반응형 디자인

#### 테스트 케이스 4-5: 모바일 반응형

- [ ] **테스트 디바이스**:
  - [ ] iPhone 12 (390×844)
  - [ ] Samsung Galaxy S21 (360×800)
  - [ ] iPad (810×1080)

- [ ] **확인 사항**:
  - [ ] Overlay 크기 자동 조정
  - [ ] 텍스트 가독성
  - [ ] 터치 인터랙션
  - [ ] 세로/가로 모드

**소요 시간**: 10분
**우선순위**: P1

---

### 4.5 다크모드

#### 테스트 케이스 4-6: 다크모드 지원

- [ ] **확인 방법**:
  - OS 설정 → 다크모드 활성화
  - 앱 새로고침

- [ ] **확인 사항**:
  - [ ] 배경색 자동 전환
  - [ ] 텍스트 색상 대비 유지
  - [ ] Overlay 배경 조정

**소요 시간**: 3분
**우선순위**: P2

---

## 5. 통합 테스트 시나리오

### 시나리오 1: 첫 대화 (신규 사용자)

**목표**: 전체 플로우 동작 확인

**단계**:
1. [ ] 앱 접속
2. [ ] "세션 시작" 버튼 클릭
3. [ ] 카메라/마이크 권한 허용
4. [ ] 얼굴이 감지되는지 확인
5. [ ] "안녕하세요" 말하기
6. [ ] STT 결과 확인
7. [ ] Overlay에 사용자 메시지 표시 확인
8. [ ] 3초 후 사라지는지 확인
9. [ ] AI 응답 스트리밍 확인
10. [ ] TTS 재생 확인
11. [ ] Overlay 자동 숨김 확인

**예상 소요**: 3분
**성공 기준**: 모든 단계 정상 작동
**우선순위**: P0

---

### 시나리오 2: 연속 대화 (10회)

**목표**: 장시간 사용 안정성

**단계**:
1. [ ] 세션 시작
2. [ ] 10번 연속 대화
3. [ ] 각 대화마다:
   - 음성 입력
   - AI 응답
   - TTS 재생
   - Overlay 표시/숨김
4. [ ] 메모리 누수 확인
5. [ ] 응답 시간 일정 유지 확인

**예상 소요**: 15분
**성공 기준**:
- 10회 모두 정상 작동
- 응답 시간 < 2초 유지
- 메모리 사용량 < 200MB
**우선순위**: P0

---

### 시나리오 3: 빠른 연속 입력

**목표**: Race condition 테스트

**단계**:
1. [ ] 세션 시작
2. [ ] "안녕하세요" 말하기
3. [ ] AI 응답 기다리지 않고 즉시 다시 "반가워요" 말하기
4. [ ] 두 응답 모두 정상 처리되는지 확인

**예상 소요**: 3분
**성공 기준**:
- 두 요청 모두 처리
- 순서 보장
- UI 꼬이지 않음
**우선순위**: P1

---

### 시나리오 4: 네트워크 불안정

**목표**: 재연결 안정성

**단계**:
1. [ ] 세션 시작 후 대화 진행
2. [ ] 브라우저 개발자 도구 → Network → "Offline" 체크
3. [ ] 메시지 입력 시도
4. [ ] 에러 메시지 확인
5. [ ] "Online" 복구
6. [ ] 자동 재연결 확인
7. [ ] 대화 재개 확인

**예상 소요**: 5분
**성공 기준**:
- 재연결 성공
- 사용자에게 재연결 안내
**우선순위**: P1

---

### 시나리오 5: 세션 만료

**목표**: Foreign key 에러 처리

**단계**:
1. [ ] 세션 시작 (Session ID 기록)
2. [ ] Backend에서 해당 세션 삭제 (수동)
3. [ ] Frontend에서 메시지 전송
4. [ ] Frontend가 FK 에러 감지하는지 확인
5. [ ] "세션이 만료되었습니다" 메시지 표시 확인
6. [ ] 새로고침 안내 확인

**예상 소요**: 5분
**성공 기준**:
- FK 에러 자동 감지
- 사용자 친화적 메시지
**우선순위**: P1

---

### 시나리오 6: 긴 응답 (2000자)

**목표**: 대용량 응답 처리

**단계**:
1. [ ] "자세히 설명해주세요" 입력
2. [ ] 긴 AI 응답 (1500자 이상) 수신
3. [ ] 스트리밍 청크 처리 확인
4. [ ] Overlay에 전체 메시지 표시 확인
5. [ ] TTS 재생 확인 (길이 고려)

**예상 소요**: 5분
**성공 기준**:
- 전체 메시지 표시
- Overlay 크기 자동 조정
- TTS 정상 재생
**우선순위**: P2

---

### 시나리오 7: 여러 감정 전환

**목표**: 감정 기반 응답 변화

**단계**:
1. [ ] 웃는 얼굴 → "기분 좋아요" → 긍정적 응답 확인
2. [ ] 슬픈 얼굴 → "우울해요" → 공감적 응답 확인
3. [ ] 화난 얼굴 → "화가 나요" → 진정 유도 응답 확인
4. [ ] 불안한 얼굴 → "걱정돼요" → 안정감 제공 응답 확인

**예상 소요**: 10분
**성공 기준**:
- 각 감정별 적절한 응답
- 감정 배지 정확히 표시
**우선순위**: P1

---

### 시나리오 8: 동시 다중 사용자 (선택)

**목표**: 백엔드 부하 테스트

**단계**:
1. [ ] 5명의 테스터가 동시에 세션 시작
2. [ ] 각자 대화 진행
3. [ ] 서로의 응답이 섞이지 않는지 확인

**예상 소요**: 10분
**성공 기준**:
- 각 세션 독립적
- 응답 시간 저하 < 50%
**우선순위**: P2
**담당**: Backend + QA

---

## 6. 에러 시나리오

### 6.1 입력 검증 에러

#### 에러 1: 빈 메시지 전송
- [ ] **재현**: 아무것도 말하지 않고 전송
- [ ] **예상 에러**: "메시지를 입력해주세요"
- [ ] **확인**: Overlay 표시 안 됨

---

#### 에러 2: 2000자 초과
- [ ] **재현**: 매우 긴 텍스트 입력 (수동 또는 자동)
- [ ] **예상 에러**: "메시지가 너무 깁니다 (최대 2000자)"
- [ ] **확인**: Backend 전송 전 차단

---

### 6.2 권한 에러

#### 에러 3: 카메라 접근 거부
- [ ] **재현**: 브라우저 설정에서 카메라 차단
- [ ] **예상 에러**: "카메라 접근 권한이 필요합니다"
- [ ] **확인**: 재시도 방법 안내

---

#### 에러 4: 마이크 접근 거부
- [ ] **재현**: 브라우저 설정에서 마이크 차단
- [ ] **예상 에러**: "마이크 접근 권한이 필요합니다"
- [ ] **확인**: 음성 입력 불가능, 안내 표시

---

### 6.3 네트워크 에러

#### 에러 5: WebSocket 연결 실패
- [ ] **재현**:
  - Backend 서버 중단
  - 또는 잘못된 WebSocket URL
- [ ] **예상 에러**: "서버에 연결할 수 없습니다"
- [ ] **확인**: 재연결 시도, 사용자 안내

---

#### 에러 6: 네트워크 타임아웃
- [ ] **재현**:
  - 브라우저 개발자 도구 → Network → "Slow 3G"
  - AI 요청 전송
- [ ] **예상 에러**: "응답 시간 초과"
- [ ] **확인**: 45초 타임아웃 후 에러 표시

---

### 6.4 Backend 에러

#### 에러 7: Gemini API 에러
- [ ] **재현**: Backend에서 Gemini API 키 잘못 설정
- [ ] **예상 에러**: "AI 서비스가 일시적으로 사용할 수 없습니다"
- [ ] **확인**: 기술적 세부사항 노출 안 됨

---

#### 에러 8: Foreign Key 제약 위반
- [ ] **재현**: Backend에서 sessions 테이블에 session_id 없는 상태
- [ ] **예상 에러**: "세션이 만료되었습니다"
- [ ] **확인**:
  - Frontend가 FK 에러 패턴 감지
  - 자동으로 사용자 친화적 메시지로 변환
  - 새로고침 안내

---

#### 에러 9: Rate Limiting
- [ ] **재현**: 1분에 11회 이상 요청
- [ ] **예상 에러**: "요청 횟수가 초과되었습니다"
- [ ] **확인**: 1분 후 자동 복구

---

## 7. 성능 점검

### 7.1 초기 로딩 성능

#### 측정 1: 페이지 로드 시간
- [ ] **측정 지표**:
  - LCP (Largest Contentful Paint): < 2.5초
  - FID (First Input Delay): < 100ms
  - CLS (Cumulative Layout Shift): < 0.1

- [ ] **측정 도구**:
  - Chrome DevTools → Lighthouse
  - Performance 탭

**목표**: Lighthouse 점수 90+ (Performance)

---

### 7.2 런타임 성능

#### 측정 2: 메모리 사용량
- [ ] **측정 방법**:
  - Chrome DevTools → Memory → "Take heap snapshot"
  - 세션 시작 직후
  - 10회 대화 후
  - 세션 종료 후

- [ ] **성공 기준**:
  - 초기: < 50MB
  - 10회 대화 후: < 100MB
  - 세션 종료 후: 메모리 정리 확인 (< 20MB)

---

#### 측정 3: CPU 사용률
- [ ] **측정 방법**:
  - Chrome DevTools → Performance → "Record"
  - 대화 진행
  - "Stop" 후 CPU 사용률 확인

- [ ] **성공 기준**:
  - 평균: < 30%
  - 최대: < 80% (짧은 스파이크 허용)

---

### 7.3 네트워크 성능

#### 측정 4: WebSocket 메시지 크기
- [ ] **측정**:
  - Network 탭 → WS → 메시지 크기 확인

- [ ] **성공 기준**:
  - 요청: < 2KB
  - 응답 (청크당): < 500 bytes
  - 전체 응답: < 10KB

---

## 8. 접근성 점검 (WCAG 2.1 AA)

### 8.1 키보드 네비게이션

#### 테스트 8-1: Tab 키 순서
- [ ] **확인**:
  - Tab 키로 모든 인터랙티브 요소 접근 가능
  - 순서가 논리적
  - 포커스 인디케이터 명확

---

### 8.2 스크린 리더

#### 테스트 8-2: ARIA 레이블
- [ ] **확인**:
  - Overlay에 `role="status"` 또는 `role="alert"`
  - 감정 배지에 `aria-label`
  - 버튼에 명확한 레이블

---

### 8.3 색상 대비

#### 테스트 8-3: 텍스트 가독성
- [ ] **확인**:
  - 텍스트 대비: 4.5:1 이상
  - 큰 텍스트 (18pt+): 3:1 이상

- [ ] **도구**:
  - Chrome DevTools → Accessibility 탭
  - Contrast Checker

---

## 9. 테스트 자동화

### 9.1 E2E 테스트 (Playwright)

```typescript
// tests/ai-voice-chat.spec.ts
import { test, expect } from '@playwright/test';

test('AI 음성 채팅 전체 플로우', async ({ page }) => {
  // 1. 세션 시작
  await page.goto('/');
  await page.click('button:has-text("세션 시작")');

  // 2. WebSocket 연결 확인
  await page.waitForSelector('video');

  // 3. 메시지 전송 시뮬레이션
  await page.evaluate(() => {
    window.dispatchEvent(new CustomEvent('ai:userMessage', {
      detail: { message: '안녕하세요', timestamp: Date.now() }
    }));
  });

  // 4. Overlay 표시 확인
  await expect(page.locator('[data-testid="ai-overlay"]')).toBeVisible();

  // 5. AI 응답 시뮬레이션
  await page.evaluate(() => {
    window.dispatchEvent(new CustomEvent('ai:begin', { detail: {} }));
    window.dispatchEvent(new CustomEvent('ai:append', {
      detail: { chunk: '안녕하세요!' }
    }));
    window.dispatchEvent(new CustomEvent('ai:complete', { detail: {} }));
  });

  // 6. 최종 메시지 확인
  await expect(page.locator('[data-testid="ai-overlay"]'))
    .toContainText('안녕하세요!');
});
```

---

### 9.2 성능 벤치마크

```javascript
// tests/performance.spec.js
const { chromium } = require('playwright');

(async () => {
  const browser = await chromium.launch();
  const page = await browser.newPage();

  // 성능 측정 시작
  await page.goto('/');

  const metrics = await page.evaluate(() => {
    return {
      LCP: performance.getEntriesByType('largest-contentful-paint')[0]?.renderTime,
      FCP: performance.getEntriesByType('paint').find(e => e.name === 'first-contentful-paint')?.startTime
    };
  });

  console.log('Performance Metrics:', metrics);

  // 기준값 확인
  if (metrics.LCP > 2500) {
    console.error('❌ LCP too slow:', metrics.LCP);
    process.exit(1);
  }

  console.log('✅ Performance OK');
  await browser.close();
})();
```

---

## 10. 버그 리포트 템플릿

### 버그 리포트 양식

```markdown
## 🐛 버그 리포트

**제목**: [간단명료한 제목]

**우선순위**: P0 / P1 / P2

**발견 일시**: YYYY-MM-DD HH:MM

**발견자**: [이름]

---

### 재현 단계

1. [단계 1]
2. [단계 2]
3. [단계 3]

---

### 예상 결과

[무엇이 일어나야 하는가]

---

### 실제 결과

[실제로 무엇이 일어났는가]

---

### 환경 정보

- **OS**: Windows 11 / macOS 14 / etc.
- **브라우저**: Chrome 120 / Safari 17 / etc.
- **화면 해상도**: 1920×1080
- **디바이스**: Desktop / Mobile
- **네트워크**: WiFi / 4G / 5G

---

### 추가 정보

- **스크린샷/비디오**: [첨부]
- **콘솔 로그**: [에러 메시지 복사]
- **네트워크 로그**: [WS 메시지 복사]

---

### 관련 이슈

- 관련 이슈 #123
- 중복 가능 #456
```

---

## 📊 테스트 진행 상황 추적

### 전체 체크리스트 요약

| 카테고리 | 총 항목 | 완료 | 진행률 |
|---------|--------|------|--------|
| User Flow | 6 | 0 | 0% |
| Data Flow | 3 | 0 | 0% |
| UX | 5 | 0 | 0% |
| UI | 6 | 0 | 0% |
| 통합 시나리오 | 8 | 0 | 0% |
| 에러 시나리오 | 9 | 0 | 0% |
| 성능 | 4 | 0 | 0% |
| 접근성 | 3 | 0 | 0% |
| **전체** | **44** | **0** | **0%** |

---

## 🎯 우선순위별 테스트 순서

### Phase 1: 핵심 기능 (P0)
**예상 소요**: 1-2시간

1. [ ] User Flow - 정상 세션 시작
2. [ ] User Flow - 정상 대화 플로우
3. [ ] Data Flow - AI 응답 요청 메시지 검증
4. [ ] Data Flow - 스트리밍 응답 검증
5. [ ] UX - 첫 AI 응답 시간
6. [ ] UX - 에러 메시지 명확성
7. [ ] UX - Auto-trigger 기능
8. [ ] 통합 시나리오 - 첫 대화
9. [ ] 통합 시나리오 - 연속 대화 (10회)

---

### Phase 2: 중요 기능 (P1)
**예상 소요**: 2-3시간

10. [ ] User Flow - 감정별 AI 응답 차이
11. [ ] UX - 로딩 인디케이터
12. [ ] UI - Video Overlay 위치 및 크기
13. [ ] UI - 감정 배지 표시
14. [ ] UI - 에러 UI 스타일
15. [ ] UI - 모바일 반응형
16. [ ] 통합 시나리오 - 빠른 연속 입력
17. [ ] 통합 시나리오 - 네트워크 불안정
18. [ ] 통합 시나리오 - 세션 만료
19. [ ] 에러 시나리오 - 모든 에러 타입

---

### Phase 3: 개선 사항 (P2)
**예상 소요**: 1-2시간

20. [ ] UI - Overlay 애니메이션
21. [ ] UI - 다크모드
22. [ ] 통합 시나리오 - 긴 응답
23. [ ] 성능 - 모든 메트릭
24. [ ] 접근성 - 모든 체크리스트

---

## 📝 테스트 완료 후

### 최종 체크리스트

- [ ] 모든 P0 테스트 통과
- [ ] 모든 P1 테스트 통과
- [ ] 버그 리포트 작성 (있는 경우)
- [ ] 테스트 결과 문서화
- [ ] 개발팀과 결과 공유
- [ ] 배포 승인 요청

---

**마지막 업데이트**: 2025-01-14
**문서 버전**: v1.0
**다음 리뷰**: 배포 후 1주일

**Happy Testing! 🧪**
