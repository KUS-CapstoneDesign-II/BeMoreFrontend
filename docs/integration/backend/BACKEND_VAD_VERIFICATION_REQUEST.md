# Backend íŒ€ê»˜: VAD ë©”ì‹œì§€ í˜•ì‹ ê²€ì¦ ìš”ì²­

**ì‘ì„±ì¼**: 2024-11-04
**From**: Frontend Team (Phase 9)
**Priority**: ğŸ”´ **High** - Frontend ì™„ì„±ë„ 95%, Backend í™•ì¸ ëŒ€ê¸°
**Timeline**: 24ì‹œê°„ ë‚´ ì‘ë‹µ ìš”ì²­

---

## ğŸ“‹ Executive Summary

Frontend Phase 9 (Frontend-Backend í†µí•©) ì‘ì—…ì´ ê±°ì˜ ì™„ë£Œë˜ì—ˆìœ¼ë‚˜, **VAD(ìŒì„± í™œë™) ë°ì´í„° í˜•ì‹ ë¶ˆì¼ì¹˜**ë¡œ ì¸í•´ NaN ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤.

**ìš”ì²­**: Backendì—ì„œ ë³´ë‚´ëŠ” `vad_analysis` ë©”ì‹œì§€ì˜ ì •í™•í•œ í•„ë“œëª…ê³¼ ë°ì´í„° í˜•ì‹ í™•ì¸

---

## âœ… ì™„ë£Œëœ Phase 9 ì‘ì—…

| í•­ëª© | ìƒíƒœ | ì„¤ëª… |
|------|------|------|
| API Endpoint ë™ê¸°í™” | âœ… | 3ê°€ì§€ ë¯¸ìŠ¤ë§¤ì¹˜ ìˆ˜ì • ì™„ë£Œ |
| Batch API | âœ… | `/api/session/batch-tick` í˜¸í™˜ì„± í™•ë³´ |
| Retry Policy | âœ… | 1s, 3s, 10s + jitter ë™ê¸°í™” |
| Rate Limiting | âœ… | HTTP 429 Retry-After ì²˜ë¦¬ |
| CI/CD | âœ… | GitHub Actions íŒŒì´í”„ë¼ì¸ ìˆ˜ì • |
| Service Worker | âœ… | ìºì‹± ì •ì±… êµ¬í˜„ |
| Keep-Alive | âœ… | 25ë¶„ ì£¼ê¸° health check |
| WebSocket | âœ… | 3ì±„ë„ ì •ìƒ ì‘ë™ |
| **VAD ì²˜ë¦¬** | âš ï¸ | **Backend í™•ì¸ ëŒ€ê¸°** |

---

## ğŸ”´ í˜„ì¬ ì´ìŠˆ: VAD ë°ì´í„° NaN ì—ëŸ¬

### ì¦ìƒ

**Frontend í™”ë©´ í‘œì‹œ**:
```
âŒ ë°œí™” ë¹„ìœ¨: NaN%
âŒ ì¹¨ë¬µ ë¹„ìœ¨: NaN%
âŒ í‰ê·  ì¹¨ë¬µ: NaNs
âŒ ìµœì¥ ì¹¨ë¬µ: NaNs
```

**ì½˜ì†” ë¡œê·¸**:
```
âœ… ğŸ¤ Voice message: {type: 'vad_analysis', data: {...}}  â† ë©”ì‹œì§€ ë„ì°©í•¨
âŒ Math.round(undefined * 100) = NaN                      â† í•„ë“œê°’ì´ undefined
```

### ê·¼ë³¸ ì›ì¸ (Frontend ë¶„ì„)

**Frontendê°€ ê¸°ëŒ€í•˜ëŠ” êµ¬ì¡°**:
```typescript
interface VADMetrics {
  speechRatio: number;          // camelCase, 0.0-1.0
  pauseRatio: number;
  averagePauseDuration: number; // ë°€ë¦¬ì´ˆ(ms)
  longestPause: number;
  speechBurstCount: number;
  averageSpeechBurst: number;
  pauseCount: number;
  summary: string;
}
```

**ê°€ëŠ¥í•œ Backend í˜•ì‹ (ë¶ˆì¼ì¹˜)**:
```javascript
// Case 1: snake_case (í˜„ì¬ ê°€ëŠ¥ì„± ê°€ì¥ ë†’ìŒ)
{
  speech_ratio: 0.65,
  pause_ratio: 0.35,
  average_pause_duration: 2500,
  // ...
}

// Case 2: 0-100 ë²”ìœ„ + ì´ˆ ë‹¨ìœ„
{
  speechRatio: 65,              // 0-100 ë²”ìœ„
  pauseRatio: 35,
  averagePauseDuration: 2.5,    // ì´ˆ ë‹¨ìœ„
  // ...
}

// Case 3: í˜¼í•© í˜•ì‹
{
  // ë‹¤ì–‘í•œ ì¡°í•©...
}
```

---

## ğŸ¯ Backend í™•ì¸ í•­ëª©

### 1ï¸âƒ£ VAD ë©”ì‹œì§€ í˜•ì‹ ì •í™• í™•ì¸

**ì§ˆë¬¸ 1: í•„ë“œëª… ìŠ¤íƒ€ì¼**
- [ ] **camelCase** (Frontend ê¸°ëŒ€) â†’ `speechRatio`
- [ ] **snake_case** â†’ `speech_ratio`
- [ ] ê¸°íƒ€: ___

**ì§ˆë¬¸ 2: ë¹„ìœ¨ ë°ì´í„° ë²”ìœ„**
- [ ] **0.0 ~ 1.0** (Frontend ê¸°ëŒ€) â†’ `speechRatio: 0.65`
- [ ] **0 ~ 100** â†’ `speechRatio: 65`
- [ ] ê¸°íƒ€: ___

**ì§ˆë¬¸ 3: ì‹œê°„ ë°ì´í„° ë‹¨ìœ„**
- [ ] **ë°€ë¦¬ì´ˆ(ms)** (Frontend ê¸°ëŒ€) â†’ `averagePauseDuration: 2500`
- [ ] **ì´ˆ(s)** â†’ `averagePauseDuration: 2.5`
- [ ] ê¸°íƒ€: ___

### 2ï¸âƒ£ í˜„ì¬ Backend VAD êµ¬í˜„ ì½”ë“œ

Backend VAD ë¶„ì„ ê²°ê³¼ë¥¼ ìƒì„±í•˜ëŠ” ì½”ë“œì—ì„œ:

1. **ì–´ë–¤ í•„ë“œë¥¼ ê³„ì‚°í•˜ëŠ”ê°€?**
   ```
   - speechRatio âœ…/âŒ
   - pauseRatio âœ…/âŒ
   - averagePauseDuration âœ…/âŒ
   - longestPause âœ…/âŒ
   - speechBurstCount âœ…/âŒ
   - averageSpeechBurst âœ…/âŒ
   - pauseCount âœ…/âŒ
   - summary âœ…/âŒ
   ```

2. **í•„ë“œëª… ê·œì¹™ì€?**
   - ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì–´ë–¤ ìŠ¤íƒ€ì¼ë¡œ ì •ì˜ë˜ì—ˆëŠ”ê°€?

3. **ê°’ì˜ ë²”ìœ„ì™€ ë‹¨ìœ„ëŠ”?**
   - ê³„ì‚° ë¡œì§ì—ì„œ ì–´ë–¤ ë²”ìœ„ì™€ ë‹¨ìœ„ë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?

### 3ï¸âƒ£ ìƒ˜í”Œ VAD ë©”ì‹œì§€ ì œê³µ

**ìµœê·¼ ì„¸ì…˜ì—ì„œ ë³´ë‚¸ ì‹¤ì œ `vad_analysis` ë©”ì‹œì§€ 1-2ê°œ** ì œê³µ ìš”ì²­:

```json
{
  "type": "vad_analysis",
  "data": {
    // â† ì‹¤ì œ í•„ë“œë“¤ ë³µì‚¬ ë¶™ì—¬ë„£ê¸°
  }
}
```

ë˜ëŠ” ì½”ë“œì—ì„œ ë‹¤ìŒ ë°©ì‹ìœ¼ë¡œ ë¡œê·¸ ì¶œë ¥:
```python
print(json.dumps(vad_message, indent=2))
```

---

## ğŸ“¦ Frontendì—ì„œ ê¸°ëŒ€í•˜ëŠ” ë©”ì‹œì§€ í˜•ì‹

```json
{
  "type": "vad_analysis",
  "data": {
    "speechRatio": 0.65,
    "pauseRatio": 0.35,
    "averagePauseDuration": 1500,
    "longestPause": 3000,
    "speechBurstCount": 12,
    "averageSpeechBurst": 2500,
    "pauseCount": 8,
    "summary": "ìì—°ìŠ¤ëŸ¬ìš´ ë°œí™” íŒ¨í„´ì…ë‹ˆë‹¤"
  }
}
```

**í•„ë“œë³„ ì„¤ëª…**:

| í•„ë“œëª… | íƒ€ì… | ë²”ìœ„ | ë‹¨ìœ„ | ì„¤ëª… |
|-------|------|------|------|------|
| speechRatio | number | 0.0~1.0 | - | ì „ì²´ ì„¸ì…˜ ì¤‘ ë°œí™”í•œ ë¹„ìœ¨ |
| pauseRatio | number | 0.0~1.0 | - | ì „ì²´ ì„¸ì…˜ ì¤‘ ì¹¨ë¬µí•œ ë¹„ìœ¨ |
| averagePauseDuration | number | 0~ | ms | í‰ê·  ì¹¨ë¬µ ê¸¸ì´ |
| longestPause | number | 0~ | ms | ê°€ì¥ ê¸´ ì¹¨ë¬µ ê¸¸ì´ |
| speechBurstCount | number | 0~ | - | ë°œí™”í•œ íšŸìˆ˜ |
| averageSpeechBurst | number | 0~ | ms | í‰ê·  ë°œí™” ê¸¸ì´ |
| pauseCount | number | 0~ | - | ì¹¨ë¬µí•œ íšŸìˆ˜ |
| summary | string | - | - | ìŒì„± í™œë™ ë¶„ì„ ìš”ì•½ |

---

## ğŸ§ª Test ë©”ì‹œì§€ ìš”ì²­

**Backend ê²€ì¦ í›„ Frontend í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´**:

ìœ„ì˜ ì •í™•í•œ í˜•ì‹ìœ¼ë¡œ test ë©”ì‹œì§€ë¥¼ **í•œ ë²ˆë§Œ** ìˆ˜ë™ìœ¼ë¡œ ë³´ë‚´ì£¼ì‹¤ ìˆ˜ ìˆë‚˜ìš”?

FrontendëŠ” ì´ ë©”ì‹œì§€ë¥¼ ë°›ìœ¼ë©´:
1. ë©”ì‹œì§€ ë¡œê·¸ í™•ì¸
2. í•„ë“œëª… ë§¤í•‘ í™•ì¸
3. ë°ì´í„° ë²”ìœ„ í™•ì¸
4. UIì— ì •ìƒ í‘œì‹œ ì—¬ë¶€ í™•ì¸

---

## ğŸ“„ Frontend ì¤€ë¹„ ìƒí™©

### ì´ë¯¸ ì¤€ë¹„ëœ ê²ƒë“¤

1. **VAD ìœ í‹¸ë¦¬í‹°** (33ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ í¬í•¨)
   - í•„ë“œëª… ë§¤í•‘ í•¨ìˆ˜
   - ë²”ìœ„ ì •ê·œí™” í•¨ìˆ˜
   - ì‹œê°„ ë‹¨ìœ„ ë³€í™˜ í•¨ìˆ˜
   - ë°ì´í„° ê²€ì¦ í•¨ìˆ˜
   - í˜•ì‹ ë¶„ì„ í•¨ìˆ˜

2. **UI ì»´í¬ë„ŒíŠ¸** (ì™„ì„±)
   - ReportPage VAD ì„¹ì…˜
   - SessionSummaryReport VAD í‘œì‹œ
   - VADMonitor (ì‹¤ì‹œê°„ í‘œì‹œ)

3. **WebSocket ë©”ì‹œì§€ í•¸ë“¤ëŸ¬** (ì¤€ë¹„ ì™„ë£Œ)
   - `src/App.tsx:144-197`ì— VAD ì²˜ë¦¬ ë¡œì§

### Backend í™•ì¸ í›„ ì¦‰ì‹œ ì‹¤í–‰í•  ì‘ì—…

1. **í•„ë“œëª… ë™ê¸°í™”** (1-2ì‹œê°„)
   - snake_case â†’ camelCase ë³€í™˜ í•¨ìˆ˜ ì¶”ê°€

2. **ë°ì´í„° ê²€ì¦ ì ìš©** (1ì‹œê°„)
   - ë²”ìœ„ ì •ê·œí™”
   - ì‹œê°„ ë‹¨ìœ„ ë³€í™˜
   - íƒ€ì… ê²€ì¦

3. **ë¦¬í¬íŠ¸ í‘œì‹œ** (1ì‹œê°„)
   - ReportPageì— VAD ì„¹ì…˜ í‘œì‹œ
   - SessionSummaryReport ì—…ë°ì´íŠ¸

4. **E2E í…ŒìŠ¤íŠ¸** (2-3ì‹œê°„)
   - ì „ì²´ ì„¸ì…˜ íë¦„ì—ì„œ VAD í‘œì‹œ í™•ì¸

**Total**: 12ì‹œê°„ ì´ë‚´ ì™„ì„± ê°€ëŠ¥

---

## ğŸ“‹ ì‘ë‹µ ì²´í¬ë¦¬ìŠ¤íŠ¸

Backendì—ì„œ ì‘ë‹µí•  ë•Œ ë‹¤ìŒì„ í¬í•¨í•´ì£¼ì„¸ìš”:

```markdown
## Backend VAD ë©”ì‹œì§€ í˜•ì‹ í™•ì¸

### í•„ë“œëª… ê·œì¹™
- [ ] camelCase (ì˜ˆ: `speechRatio`)
- [ ] snake_case (ì˜ˆ: `speech_ratio`)
- [ ] ê¸°íƒ€: ___

### ë¹„ìœ¨ ë²”ìœ„
- [ ] 0.0 ~ 1.0
- [ ] 0 ~ 100
- [ ] ê¸°íƒ€: ___

### ì‹œê°„ ë‹¨ìœ„
- [ ] ë°€ë¦¬ì´ˆ(ms)
- [ ] ì´ˆ(s)
- [ ] ê¸°íƒ€: ___

### ìƒ˜í”Œ ë©”ì‹œì§€
```json
{
  "type": "vad_analysis",
  "data": {
    // ì‹¤ì œ í•„ë“œë“¤
  }
}
```

### ì¶”ê°€ ì •ë³´
- ëª¨ë“  8ê°œ í•„ë“œê°€ í•­ìƒ í¬í•¨ë˜ëŠ”ê°€?
- íŠ¹ë³„í•œ ê²½ìš°(ì˜ˆ: VAD ë¶„ì„ ë¶ˆê°€)ì—ëŠ” ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ê°€?
- VAD ë©”ì‹œì§€ ì „ì†¡ ë¹ˆë„ëŠ”? (ë§¤ë¶„? ë§¤ 5ë¶„?)
```

---

## ğŸ”— ì°¸ê³  íŒŒì¼

**Frontendì—ì„œ VAD ê´€ë ¨ íŒŒì¼ë“¤**:

```
src/
â”œâ”€â”€ types/index.ts              (VADMetrics íƒ€ì… ì •ì˜)
â”œâ”€â”€ App.tsx                     (ë©”ì‹œì§€ ì²˜ë¦¬: line 144-197)
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ vadStore.ts            (VAD ì „ì—­ ìƒíƒœ)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ VAD/
â”‚   â”‚   â””â”€â”€ VADMonitor.tsx      (ì‹¤ì‹œê°„ VAD í‘œì‹œ)
â”‚   â””â”€â”€ Session/
â”‚       â”œâ”€â”€ ReportPage.tsx      (ë¦¬í¬íŠ¸ í˜ì´ì§€)
â”‚       â””â”€â”€ SessionSummaryReport.tsx (ìš”ì•½ ë¦¬í¬íŠ¸)
â””â”€â”€ utils/
    â”œâ”€â”€ vadUtils.ts            (ë³€í™˜ ìœ í‹¸ë¦¬í‹°)
    â””â”€â”€ vadValidator.ts        (ê²€ì¦ í•¨ìˆ˜)
```

**ë¬¸ì„œ**:
- `VAD_AND_REPORT_DATA_ANALYSIS.md` - Frontend ìƒì„¸ ë¶„ì„
- `BACKEND_VAD_DEBUG_REQUEST.md` - Frontend ë””ë²„ê¹… ë„êµ¬

---

## ğŸ“ Contact & Communication

**Frontend Lead**: Claude Code
**Priority**: ğŸ”´ High - í†µí•© ì™„ì„±ë„ 95%
**Expected Response Time**: 24ì‹œê°„ ì´ë‚´
**Response Channel**: Slack / ì´ë©”ì¼ / PR Comment

---

## â±ï¸ Timeline

```
2024-11-04
â”œâ”€ 14:00 Frontend VAD ì´ìŠˆ ë¶„ì„ ì™„ë£Œ
â”œâ”€ 15:00 Backend ê²€ì¦ ìš”ì²­ ë°œì†¡ â† í˜„ì¬
â””â”€ 24ì‹œê°„ ë‚´

2024-11-05
â”œâ”€ Backend ì‘ë‹µ ìˆ˜ë ¹
â”œâ”€ Frontend í•„ë“œëª… ë§¤í•‘ ì ìš© (1-2ì‹œê°„)
â”œâ”€ ë°ì´í„° ê²€ì¦ + UI í‘œì‹œ (2ì‹œê°„)
â”œâ”€ E2E í…ŒìŠ¤íŠ¸ (2-3ì‹œê°„)
â””â”€ ì™„ë£Œ

2024-11-05 ~ 11-06
â””â”€ Staging ê²€ì¦ + Production Deploy
```

---

## âœ¨ ìš”ì•½

| í•­ëª© | ìƒíƒœ |
|------|------|
| Frontend êµ¬í˜„ | âœ… 95% ì™„ë£Œ |
| Backend ë°ì´í„° | â³ í˜•ì‹ í™•ì¸ ëŒ€ê¸° |
| í†µí•© ì™„ì„±ë„ | â³ Backend í™•ì¸ í›„ 100% |
| ì˜ˆìƒ í•´ê²° ì‹œê°„ | 12ì‹œê°„ (í™•ì¸ í›„) |

---

**ğŸ™ ë¹ ë¥¸ ì‘ë‹µ ë¶€íƒë“œë¦½ë‹ˆë‹¤!**

ë¬¸ì˜ì‚¬í•­ì´ë‚˜ ì¶”ê°€ ì •ë³´ í•„ìš”ì‹œ ì–¸ì œë“  ì—°ë½ì£¼ì„¸ìš”.

