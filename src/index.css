@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --font-scale: 1;

  /* ===== WCAG AAA Color Contrast Variables (A-01) ===== */
  /* Primary colors - all meet 7:1 contrast on white background */
  --color-primary-500: #0d7d72;
  --color-primary-600: #065f57;
  --color-primary-700: #044e48;

  /* Emotion colors - all meet enhanced contrast on white background */
  --color-emotion-happy: #b45309;
  --color-emotion-sad: #1e40af;
  --color-emotion-angry: #b91c1c;
  --color-emotion-anxious: #6d28d9;
  --color-emotion-neutral: #374151;
  --color-emotion-surprised: #92400e;
  --color-emotion-disgusted: #047857;
  --color-emotion-fearful: #7c3aed;

  /* Semantic colors - all meet 7:1 contrast */
  --color-success: #047857;
  --color-warning: #b45309;
  --color-error: #b91c1c;
  --color-info: #1e40af;
}

@layer base {
  html {
    font-size: calc(16px * var(--font-scale));
  }
  body {
    @apply m-0 min-h-screen bg-gray-50;
  }

  /* High contrast mode: WCAG AAA enhanced (A-01) */
  :root[data-contrast="high"] {
    /* Override color variables with ultra-dark contrast versions for maximum accessibility */
    --color-primary-500: #02332f;
    --color-primary-600: #011d1a;
    --color-emotion-happy: #6b2f08;
    --color-emotion-sad: #162563;
    --color-emotion-angry: #5a1212;
    --color-emotion-surprised: #6b2f08;
  }

  :root[data-contrast="high"] :focus {
    outline: 3px solid #000000 !important; /* Maximum contrast outline */
    outline-offset: 2px;
  }

  :root[data-contrast="high"] .text-gray-500 { color: #111827 !important; }
  :root[data-contrast="high"] .bg-gray-50 { background-color: #ffffff !important; }

  /* Enhanced contrast for interactive elements in high-contrast mode */
  :root[data-contrast="high"] button,
  :root[data-contrast="high"] a,
  :root[data-contrast="high"] [role="button"] {
    border: 2px solid currentColor !important;
  }

  /* Reduced motion */
  :root[data-motion="reduced"] * {
    animation: none !important;
    transition: none !important;
    scroll-behavior: auto !important;
  }

  /* Skip link utility if not using Tailwind's sr-only */
  .skip-link {
    position: absolute;
    left: -9999px;
    top: auto;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }
  .skip-link:focus {
    left: 8px;
    top: 8px;
    width: auto;
    height: auto;
    padding: 8px 12px;
    background: #111827;
    color: #fff;
    border-radius: 8px;
    z-index: 1000;
  }

  /* Density overrides for common spacing utilities */
  :root[data-density="compact"] .p-4 { padding: 0.75rem !important; }
  :root[data-density="compact"] .py-4 { padding-top: 0.75rem !important; padding-bottom: 0.75rem !important; }
  :root[data-density="compact"] .px-4 { padding-left: 0.75rem !important; padding-right: 0.75rem !important; }
  :root[data-density="compact"] .gap-4 { gap: 0.75rem !important; }
  :root[data-density="compact"] .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem !important; }

  /* ===== Mobile-First Responsive Design ===== */

  /* Mobile base styles (default) */
  body {
    font-size: 16px; /* Prevent zoom on focus in mobile Safari */
  }

  /* Touch-friendly button and interactive element sizing */
  button,
  a,
  [role="button"],
  input[type="button"],
  input[type="submit"],
  input[type="reset"] {
    min-height: 44px; /* WCAG AAA touch target size */
    min-width: 44px;
    padding: 0.75rem 1rem; /* Adequate padding for touch */
  }

  /* Form controls touch-friendly sizing */
  input,
  select,
  textarea {
    min-height: 44px;
    padding: 0.75rem;
    font-size: 16px; /* Prevent zoom on focus in mobile Safari */
  }

  /* Responsive typography for mobile */
  @media (max-width: 640px) {
    html {
      font-size: 14px;
    }
    h1 {
      @apply text-2xl;
    }
    h2 {
      @apply text-xl;
    }
    h3 {
      @apply text-lg;
    }
    body {
      @apply px-4;
    }
  }

  /* Tablet optimization (641px - 1024px) */
  @media (min-width: 641px) and (max-width: 1024px) {
    html {
      font-size: 15px;
    }
    h1 {
      @apply text-3xl;
    }
    h2 {
      @apply text-2xl;
    }
    body {
      @apply px-6;
    }
  }

  /* Desktop optimization (1025px+) */
  @media (min-width: 1025px) {
    html {
      font-size: 16px;
    }
    h1 {
      @apply text-4xl;
    }
    h2 {
      @apply text-3xl;
    }
    body {
      @apply px-8;
    }
  }

  /* Reduce touch target on desktop devices */
  @media (hover: hover) and (pointer: fine) {
    button,
    a,
    [role="button"],
    input[type="button"],
    input[type="submit"],
    input[type="reset"] {
      min-height: auto;
      min-width: auto;
    }
    input,
    select,
    textarea {
      min-height: auto;
    }
  }

  /* Mobile navigation optimization */
  @media (max-width: 768px) {
    /* Ensure navigation items are touch-friendly */
    nav a,
    nav button {
      @apply px-3 py-2.5;
    }

    /* Expandable menu for mobile */
    .mobile-menu {
      @apply fixed inset-0 z-50 hidden overflow-auto bg-white;
    }
    .mobile-menu.open {
      @apply block;
    }
  }

  /* Image responsiveness */
  img {
    max-width: 100%;
    height: auto;
    display: block;
  }

  /* Prevent horizontal scroll on mobile */
  @media (max-width: 640px) {
    body {
      overflow-x: hidden;
    }
    * {
      max-width: 100vw;
    }
  }

  /* Viewport meta tag support */
  @viewport {
    width: device-width;
    zoom: 1;
    user-zoom: fixed;
  }

  /* Touch feedback on mobile */
  @media (hover: none) and (pointer: coarse) {
    button,
    a,
    [role="button"],
    input[type="button"],
    input[type="submit"],
    input[type="reset"] {
      transition: opacity 150ms ease-in-out;
    }
    button:active,
    a:active,
    [role="button"]:active {
      opacity: 0.7;
    }
  }

  /* Landscape mode adjustments */
  @media (max-height: 500px) and (orientation: landscape) {
    body {
      padding: 0.5rem;
    }
    h1 {
      @apply text-xl;
    }
  }
}
